# üöÄ –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –æ–±—É—á–µ–Ω–∏—é ML –º–æ–¥–µ–ª–∏

## üìÅ –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö

–°–æ–∑–¥–∞–π—Ç–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—É –ø–∞–ø–æ–∫ —Å –≤–∞—à–∏–º–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏:

```
data/
‚îú‚îÄ‚îÄ clean_intact/      # –ß–∏—Å—Ç—ã–µ —Ü–µ–ª—ã–µ –º–∞—à–∏–Ω—ã
‚îÇ   ‚îú‚îÄ‚îÄ car1.jpg
‚îÇ   ‚îú‚îÄ‚îÄ car2.png
‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îú‚îÄ‚îÄ clean_damaged/     # –ß–∏—Å—Ç—ã–µ –±–∏—Ç—ã–µ –º–∞—à–∏–Ω—ã  
‚îÇ   ‚îú‚îÄ‚îÄ damaged1.jpg
‚îÇ   ‚îú‚îÄ‚îÄ damaged2.png
‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îú‚îÄ‚îÄ dirty_intact/      # –ì—Ä—è–∑–Ω—ã–µ —Ü–µ–ª—ã–µ –º–∞—à–∏–Ω—ã
‚îÇ   ‚îú‚îÄ‚îÄ dirty1.jpg
‚îÇ   ‚îú‚îÄ‚îÄ dirty2.png
‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îî‚îÄ‚îÄ dirty_damaged/     # –ì—Ä—è–∑–Ω—ã–µ –±–∏—Ç—ã–µ –º–∞—à–∏–Ω—ã
    ‚îú‚îÄ‚îÄ both1.jpg
    ‚îú‚îÄ‚îÄ both2.png
    ‚îî‚îÄ‚îÄ ...
```

## üõ†Ô∏è –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```bash
cd ml
pip install -r requirements.txt
```

## üéØ –ó–∞–ø—É—Å–∫ –æ–±—É—á–µ–Ω–∏—è

```bash
python train_unified_model.py
```

## üìä –ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø—Ä–∏ –æ–±—É—á–µ–Ω–∏–∏:

1. **–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö** - —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö 4 –ø–∞–ø–æ–∫
2. **–†–∞–∑–¥–µ–ª–µ–Ω–∏–µ** - 80% –æ–±—É—á–µ–Ω–∏–µ, 20% –≤–∞–ª–∏–¥–∞—Ü–∏—è
3. **–ê—É–≥–º–µ–Ω—Ç–∞—Ü–∏—è** - –ø–æ–≤–æ—Ä–æ—Ç, –∏–∑–º–µ–Ω–µ–Ω–∏–µ —è—Ä–∫–æ—Å—Ç–∏, –æ–±—Ä–µ–∑–∫–∞
4. **–û–±—É—á–µ–Ω–∏–µ** - 50 —ç–ø–æ—Ö —Å early stopping
5. **–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ** - –ª—É—á—à–∞—è –º–æ–¥–µ–ª—å –≤ `models/best_unified_model.pth`

## üìà –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –æ–±—É—á–µ–Ω–∏—è:

–ü–æ—Å–ª–µ –æ–±—É—á–µ–Ω–∏—è –ø–æ–ª—É—á–∏—Ç–µ:
- `models/best_unified_model.pth` - –ª—É—á—à–∞—è –º–æ–¥–µ–ª—å
- `models/training_history.png` - –≥—Ä–∞—Ñ–∏–∫–∏ –æ–±—É—á–µ–Ω–∏—è
- `models/confusion_matrix.png` - –º–∞—Ç—Ä–∏—Ü–∞ –æ—à–∏–±–æ–∫
- `models/inference.py` - —Å–∫—Ä–∏–ø—Ç –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –º–æ–¥–µ–ª–∏:

```bash
cd models
python inference.py ../test_image.jpg
```

–†–µ–∑—É–ª—å—Ç–∞—Ç:
```json
{
  "cleanliness": "clean",
  "cleanlinessConfidence": 0.89,
  "condition": "intact", 
  "conditionConfidence": 0.89,
  "predicted_class": "clean_intact",
  "all_probabilities": {
    "clean_intact": 0.89,
    "clean_damaged": 0.05,
    "dirty_intact": 0.04,
    "dirty_damaged": 0.02
  }
}
```

## ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –æ–±—É—á–µ–Ω–∏—è:

–í —Ñ–∞–π–ª–µ `train_unified_model.py` –º–æ–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å:

```python
BATCH_SIZE = 32        # –†–∞–∑–º–µ—Ä –±–∞—Ç—á–∞
NUM_EPOCHS = 50        # –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —ç–ø–æ—Ö
DATA_DIR = 'data'      # –ü–∞–ø–∫–∞ —Å –¥–∞–Ω–Ω—ã–º–∏
MODELS_DIR = 'models'  # –ü–∞–ø–∫–∞ –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è
```

## üéõÔ∏è –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –¥–∞–Ω–Ω—ã–º:

- **–ú–∏–Ω–∏–º—É–º**: 100 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –Ω–∞ –∫–ª–∞—Å—Å
- **–û–ø—Ç–∏–º–∞–ª—å–Ω–æ**: 500+ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –Ω–∞ –∫–ª–∞—Å—Å
- **–§–æ—Ä–º–∞—Ç—ã**: JPG, PNG, BMP, TIFF
- **–†–∞–∑—Ä–µ—à–µ–Ω–∏–µ**: –ª—é–±–æ–µ (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏–∑–º–µ–Ω–∏—Ç—Å—è –¥–æ 224x224)
- **–ö–∞—á–µ—Å—Ç–≤–æ**: —á–µ–º –≤—ã—à–µ, —Ç–µ–º –ª—É—á—à–µ

## üö® –í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã:

### –ú–∞–ª–æ –¥–∞–Ω–Ω—ã—Ö
```
‚ùå –ù–µ –Ω–∞–π–¥–µ–Ω–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –¥–ª—è –æ–±—É—á–µ–Ω–∏—è!
```
**–†–µ—à–µ–Ω–∏–µ**: –î–æ–±–∞–≤—å—Ç–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤ –ø–∞–ø–∫–∏

### –ù–µ—Ö–≤–∞—Ç–∫–∞ –ø–∞–º—è—Ç–∏
```
RuntimeError: CUDA out of memory
```
**–†–µ—à–µ–Ω–∏–µ**: –£–º–µ–Ω—å—à–∏—Ç–µ `BATCH_SIZE` –¥–æ 16 –∏–ª–∏ 8

### –ú–µ–¥–ª–µ–Ω–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ
**–†–µ—à–µ–Ω–∏–µ**: 
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ GPU (CUDA)
- –£–º–µ–Ω—å—à–∏—Ç–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —ç–ø–æ—Ö
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –º–µ–Ω—å—à–µ –∞—É–≥–º–µ–Ω—Ç–∞—Ü–∏–π

## üìã –ß–µ–∫–ª–∏—Å—Ç –ø–µ—Ä–µ–¥ –æ–±—É—á–µ–Ω–∏–µ–º:

- [ ] –î–∞–Ω–Ω—ã–µ —Ä–∞–∑–ª–æ–∂–µ–Ω—ã –ø–æ 4 –ø–∞–ø–∫–∞–º
- [ ] –í –∫–∞–∂–¥–æ–π –ø–∞–ø–∫–µ –µ—Å—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
- [ ] –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã –≤—Å–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
- [ ] –î–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –º–µ—Å—Ç–∞ –Ω–∞ –¥–∏—Å–∫–µ (>2GB)
- [ ] –î–æ—Å—Ç–∞—Ç–æ—á–Ω–æ RAM (>8GB –¥–ª—è GPU, >4GB –¥–ª—è CPU)

## üîÑ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ–º:

–ü–æ—Å–ª–µ –æ–±—É—á–µ–Ω–∏—è –º–æ–¥–µ–ª—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏–Ω—Ç–µ–≥—Ä–∏—Ä—É–µ—Ç—Å—è:

1. –ú–æ–¥–µ–ª—å —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ `ml/models/best_unified_model.pth`
2. –°–∫—Ä–∏–ø—Ç `ml/analyze.py` –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –Ω–∞–π–¥–µ—Ç –∏ –∑–∞–≥—Ä—É–∑–∏—Ç –µ—ë
3. –í–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–∞—á–Ω–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ä–µ–∞–ª—å–Ω—É—é –º–æ–¥–µ–ª—å –≤–º–µ—Å—Ç–æ –∑–∞–≥–ª—É—à–∫–∏

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞:

–ü—Ä–∏ –ø—Ä–æ–±–ª–µ–º–∞—Ö –ø—Ä–æ–≤–µ—Ä—å—Ç–µ:
1. –õ–æ–≥–∏ –æ–±—É—á–µ–Ω–∏—è –≤ –∫–æ–Ω—Å–æ–ª–∏
2. –°—Ç—Ä—É–∫—Ç—É—Ä—É –ø–∞–ø–æ–∫ —Å –¥–∞–Ω–Ω—ã–º–∏
3. –í–µ—Ä—Å–∏–∏ –±–∏–±–ª–∏–æ—Ç–µ–∫ –≤ requirements.txt