# üß† –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ ML –º–æ–¥–µ–ª–∏ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –∞–≤—Ç–æ–º–æ–±–∏–ª–µ–π

## üèóÔ∏è –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –Ω–µ–π—Ä–æ—Å–µ—Ç–∏

### **Backbone: ResNet50**
```
–í—Ö–æ–¥–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ (224x224x3)
    ‚Üì
Convolutional Layers (–∏–∑–≤–ª–µ—á–µ–Ω–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤)
    ‚Üì 
ResNet50 –±–ª–æ–∫–∏ (–≥–ª—É–±–æ–∫–æ–µ –æ–±—É—á–µ–Ω–∏–µ)
    ‚Üì
Feature Vector (2048 –ø—Ä–∏–∑–Ω–∞–∫–æ–≤)
    ‚Üì
Classifier (–Ω–∞—à–∏ —Å–ª–æ–∏)
```

### **–ù–∞—à –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ç–æ—Ä:**
```python
nn.Sequential(
    nn.Dropout(0.5),           # –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è
    nn.Linear(2048, 1024),     # 2048 ‚Üí 1024 –Ω–µ–π—Ä–æ–Ω–æ–≤
    nn.ReLU(),                 # –§—É–Ω–∫—Ü–∏—è –∞–∫—Ç–∏–≤–∞—Ü–∏–∏
    nn.BatchNorm1d(1024),      # –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è
    nn.Dropout(0.3),           # –ï—â–µ dropout
    nn.Linear(1024, 512),      # 1024 ‚Üí 512 –Ω–µ–π—Ä–æ–Ω–æ–≤
    nn.ReLU(),
    nn.BatchNorm1d(512),
    nn.Dropout(0.2),
    nn.Linear(512, 2)          # 512 ‚Üí 2 –∫–ª–∞—Å—Å–∞ (clean/dirty)
)
```

## üéØ –ü—Ä–æ—Ü–µ—Å—Å –æ–±—É—á–µ–Ω–∏—è

### **1. –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö**
```python
# –°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞–µ—Ç –º–µ—Ç–∫–∏:
clean_photos = load_from_folder("data/clean/")     # –º–µ—Ç–∫–∞ = 0
dirty_photos = load_from_folder("data/dirty/")     # –º–µ—Ç–∫–∞ = 1

# –ö–∞–∂–¥–æ–µ —Ñ–æ—Ç–æ —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –ø–∞—Ä–æ–π (–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ, –º–µ—Ç–∫–∞):
training_data = [
    (car1.jpg, 0),  # —á–∏—Å—Ç–∞—è –º–∞—à–∏–Ω–∞
    (car2.jpg, 1),  # –≥—Ä—è–∑–Ω–∞—è –º–∞—à–∏–Ω–∞
    (car3.jpg, 0),  # —á–∏—Å—Ç–∞—è –º–∞—à–∏–Ω–∞
    ...
]
```

### **2. –ü—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π**
```python
transforms.Compose([
    transforms.Resize((256, 256)),        # –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–∞
    transforms.RandomCrop(224),           # –°–ª—É—á–∞–π–Ω–∞—è –æ–±—Ä–µ–∑–∫–∞
    transforms.RandomHorizontalFlip(),    # –°–ª—É—á–∞–π–Ω—ã–π –ø–æ–≤–æ—Ä–æ—Ç
    transforms.ColorJitter(),             # –ò–∑–º–µ–Ω–µ–Ω–∏–µ —è—Ä–∫–æ—Å—Ç–∏/–∫–æ–Ω—Ç—Ä–∞—Å—Ç–∞
    transforms.ToTensor(),                # –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –≤ —Ç–µ–Ω–∑–æ—Ä
    transforms.Normalize([0.485, 0.456, 0.406], 
                        [0.229, 0.224, 0.225])  # –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è
])
```

### **3. –û–±—É—á–µ–Ω–∏–µ (—ç–ø–æ—Ö–∞ –∑–∞ —ç–ø–æ—Ö–æ–π)**
```python
for epoch in range(50):  # 50 –ø—Ä–æ—Ö–æ–¥–æ–≤ –ø–æ –≤—Å–µ–º –¥–∞–Ω–Ω—ã–º
    for batch in training_data:  # –ë–∞—Ç—á–∏ –ø–æ 32 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
        
        # –ü—Ä—è–º–æ–π –ø—Ä–æ—Ö–æ–¥
        predictions = model(images)
        loss = calculate_loss(predictions, true_labels)
        
        # –û–±—Ä–∞—Ç–Ω—ã–π –ø—Ä–æ—Ö–æ–¥ (–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤–µ—Å–æ–≤)
        loss.backward()
        optimizer.step()
        
        # –ú–æ–¥–µ–ª—å —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è —É–º–Ω–µ–µ!
```

## üîç –ß—Ç–æ –∏–∑—É—á–∞–µ—Ç –º–æ–¥–µ–ª—å

### **–ù–∏–∑–∫–æ—É—Ä–æ–≤–Ω–µ–≤—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏:**
- –ö—Ä–∞—è –∏ –∫–æ–Ω—Ç—É—Ä—ã
- –¢–µ–∫—Å—Ç—É—Ä—ã –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–∏
- –¶–≤–µ—Ç–æ–≤—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã

### **–í—ã—Å–æ–∫–æ—É—Ä–æ–≤–Ω–µ–≤—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏:**
- –§–æ—Ä–º–∞ –∞–≤—Ç–æ–º–æ–±–∏–ª—è
- –ë–ª–∏–∫–∏ –∏ –æ—Ç—Ä–∞–∂–µ–Ω–∏—è (—á–∏—Å—Ç–æ—Ç–∞)
- –¶–∞—Ä–∞–ø–∏–Ω—ã –∏ –≤–º—è—Ç–∏–Ω—ã (–ø–æ–≤—Ä–µ–∂–¥–µ–Ω–∏—è)
- –ì—Ä—è–∑—å –∏ –ø—ã–ª—å

### **–ü—Ä–∏–º–µ—Ä—ã —Ç–æ–≥–æ, —á—Ç–æ "–≤–∏–¥–∏—Ç" –º–æ–¥–µ–ª—å:**

**–î–ª—è —á–∏—Å—Ç–æ—Ç—ã:**
- –ë–ª–µ—Å—Ç—è—â–∏–µ –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–∏ ‚Üí "clean"
- –ß–µ—Ç–∫–∏–µ –æ—Ç—Ä–∞–∂–µ–Ω–∏—è ‚Üí "clean"  
- –ú–∞—Ç–æ–≤—ã–µ, –ø—ã–ª—å–Ω—ã–µ –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–∏ ‚Üí "dirty"
- –ü—è—Ç–Ω–∞ –∏ —Ä–∞–∑–≤–æ–¥—ã ‚Üí "dirty"

**–î–ª—è –ø–æ–≤—Ä–µ–∂–¥–µ–Ω–∏–π:**
- –†–æ–≤–Ω—ã–µ –ª–∏–Ω–∏–∏ –∫—É–∑–æ–≤–∞ ‚Üí "intact"
- –¶–∞—Ä–∞–ø–∏–Ω—ã, –≤–º—è—Ç–∏–Ω—ã ‚Üí "damaged"
- –†–∞–∑–±–∏—Ç—ã–µ —Ñ–∞—Ä—ã ‚Üí "damaged"
- –î–µ—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —á–∞—Å—Ç–∏ ‚Üí "damaged"

## ‚öôÔ∏è –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### **Transfer Learning:**
- –ò—Å–ø–æ–ª—å–∑—É–µ–º –ø—Ä–µ–¥–æ–±—É—á–µ–Ω–Ω—É—é ResNet50 (–æ–±—É—á–µ–Ω–∞ –Ω–∞ ImageNet)
- –ó–∞–º–æ—Ä–∞–∂–∏–≤–∞–µ–º —Ä–∞–Ω–Ω–∏–µ —Å–ª–æ–∏ (–æ–Ω–∏ —É–∂–µ —É–º–µ—é—Ç –Ω–∞—Ö–æ–¥–∏—Ç—å –±–∞–∑–æ–≤—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏)
- –î–æ–æ–±—É—á–∞–µ–º —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ–¥–Ω–∏–µ —Å–ª–æ–∏ –ø–æ–¥ –Ω–∞—à–∏ –∫–ª–∞—Å—Å—ã

### **–ê—É–≥–º–µ–Ω—Ç–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö:**
- –ü–æ–≤–æ—Ä–æ—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
- –ò–∑–º–µ–Ω–µ–Ω–∏–µ —è—Ä–∫–æ—Å—Ç–∏
- –°–ª—É—á–∞–π–Ω–∞—è –æ–±—Ä–µ–∑–∫–∞
- –ì–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ–µ –æ—Ç—Ä–∞–∂–µ–Ω–∏–µ

–≠—Ç–æ —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–∏–µ –¥–∞–Ω–Ω—ã—Ö –∏ –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ.

### **–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è:**
- **Optimizer:** AdamW (–∞–¥–∞–ø—Ç–∏–≤–Ω—ã–π –≥—Ä–∞–¥–∏–µ–Ω—Ç–Ω—ã–π —Å–ø—É—Å–∫)
- **Learning Rate:** 0.001 —Å —É–º–µ–Ω—å—à–µ–Ω–∏–µ–º
- **Loss Function:** CrossEntropyLoss
- **Batch Size:** 32 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∑–∞ —Ä–∞–∑

## üìä –ú–µ—Ç—Ä–∏–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞

### **Accuracy (–¢–æ—á–Ω–æ—Å—Ç—å):**
```
Accuracy = –ü—Ä–∞–≤–∏–ª—å–Ω—ã–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è / –í—Å–µ–≥–æ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π
```

### **Confidence (–£–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å):**
```python
probabilities = softmax(model_output)
confidence = max(probabilities)  # –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å
```

### **Confusion Matrix:**
```
           Predicted
Actual   Clean  Dirty
Clean     85     15     ‚Üê 85% –ø—Ä–∞–≤–∏–ª—å–Ω–æ –æ–ø—Ä–µ–¥–µ–ª–∏–ª–∏ —á–∏—Å—Ç—ã–µ
Dirty     10     90     ‚Üê 90% –ø—Ä–∞–≤–∏–ª—å–Ω–æ –æ–ø—Ä–µ–¥–µ–ª–∏–ª–∏ –≥—Ä—è–∑–Ω—ã–µ
```

## üöÄ –ü–æ—Å–ª–µ –æ–±—É—á–µ–Ω–∏—è

–ú–æ–¥–µ–ª—å —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ —Ñ–∞–π–ª `.pth` –∫–æ—Ç–æ—Ä—ã–π —Å–æ–¥–µ—Ä–∂–∏—Ç:
- –í–µ—Å–∞ –≤—Å–µ—Ö –Ω–µ–π—Ä–æ–Ω–æ–≤
- –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É —Å–µ—Ç–∏
- –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏

–ü—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –º–æ–¥–µ–ª—å "–ø–æ–º–Ω–∏—Ç" –≤—Å–µ —á—Ç–æ –≤—ã—É—á–∏–ª–∞ –∏ –º–æ–∂–µ—Ç –∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –Ω–æ–≤—ã–µ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏!